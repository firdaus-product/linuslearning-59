<!DOCTYPE html>
<html lang="ms-MY" class="overflow-hidden overscroll-none">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Matematik Ceria: Latihan Operasi Tolak</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

  <style>
    /* --- UI STYLE (TEMPLATE HIJAU - MASTER REFERENCE) --- */
    body {
      font-family: 'Fredoka', sans-serif;
      background-color: #f0fdf4;
      background-image: radial-gradient(#86efac 2px, transparent 2px);
      background-size: 30px 30px;
    }

    .game-card {
      background: white;
      border: 4px solid #475569;
      box-shadow: 8px 8px 0px #00000020;
      border-radius: 1.5rem;
      /* min-height: 600px; REMOVED */
      position: relative;
      display: flex;
      align-items: center;
      /* Center vertical */
      justify-content: center;
      /* Center horizontal */
      flex-direction: column;
      flex: 1;
      overflow: hidden;
    }

    /* Buttons */
    .btn-3d {
      transition: all 0.1s;
      border-bottom-width: 6px;
      border-color: rgba(0, 0, 0, 0.2);
      transform: translateY(0);
      cursor: pointer;
      display: inline-block;
    }

    .btn-3d:active:not(:disabled) {
      transform: translateY(4px);
      border-bottom-width: 2px;
      box-shadow: none;
    }

    .btn-3d:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      border-bottom-width: 6px;
      filter: grayscale(100%);
    }

    /* Animation */
    .shake {
      animation: shake 0.4s ease-in-out;
      border-color: #ef4444 !important;
      background-color: #fee2e2 !important;
    }

    @keyframes shake {

      0%,
      100% {
        transform: translateX(0);
      }

      25% {
        transform: translateX(-8px) rotate(-5deg);
      }

      75% {
        transform: translateX(8px) rotate(5deg);
      }
    }

    /* --- ADAPTASI UTK INPUT & BENTUK LAZIM --- */

    .alg-grid-input {
      display: grid;
      grid-template-columns: 40px repeat(3, 60px);
      justify-content: center;
      gap: 5px;
      background-color: #f8fafc;
      padding: 1rem;
      border-radius: 1rem;
      border: 4px solid #e2e8f0;
      font-weight: bold;
      font-size: 1.5rem;
    }

    .alg-label {
      font-size: 1.2rem;
      color: #94a3b8;
      font-weight: bold;
      padding-bottom: 0.5rem;
      text-align: center;
    }

    .alg-num {
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 0.5rem;
      position: relative;
    }

    .ans-input {
      width: 100%;
      height: 60px;
      text-align: center;
      font-family: 'Fredoka', sans-serif;
      font-size: 1.5rem;
      font-weight: bold;
      border: 2px dashed #cbd5e1;
      border-radius: 0.5rem;
      background-color: #fff;
      color: #334155;
    }

    .ans-input:focus {
      outline: none;
      border: 3px solid #22c55e;
      background-color: #f0fdf4;
    }

    .ans-input:disabled {
      background-color: #e2e8f0;
      border: none;
      color: #94a3b8;
    }

    .line-sep {
      grid-column: span 4;
      border-top: 6px solid #475569;
      margin: 5px 0;
    }

    /* STYLING PINJAM NOMBOR (Reference Style) */
    .alg-num-potong {
      color: #ef4444;
      text-decoration: line-through;
      opacity: 0.4;
    }

    .alg-num-atas {
      position: absolute;
      top: -25px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 1.5rem;
      color: #22c55e;
      font-weight: 800;
      background: #dcfce7;
      padding: 2px 10px;
      border-radius: 8px;
      border: 2px solid #22c55e;
      z-index: 10;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .alg-pinjam-sebelah {
      position: absolute;
      left: 15px;
      font-size: 1.8rem;
      color: #22c55e;
      font-weight: 800;
      top: 20px;
      z-index: 5;
    }

    /* Aktiviti Blok */
    .block-container {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .block {
      border: 3px solid rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.2s;
      color: white;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 4px 4px 0 rgba(0, 0, 0, 0.1);
    }

    .block:hover {
      transform: scale(1.05);
    }

    .block-ratus {
      width: 100px;
      height: 100px;
      background-color: #fca5a5;
      border-color: #ef4444;
      color: #7f1d1d;
    }

    .block-puluh {
      width: 30px;
      height: 80px;
      background-color: #86efac;
      border-color: #22c55e;
      color: #14532d;
      font-size: 0.8rem;
      writing-mode: vertical-rl;
    }

    .block-sa {
      width: 25px;
      height: 25px;
      background-color: #93c5fd;
      border-color: #3b82f6;
    }
  </style>
</head>

<body class="h-screen w-screen overflow-hidden text-slate-800 flex flex-col overscroll-none">

  <div class="flex-none p-4 z-50 pointer-events-none w-full">
    <div
      class="max-w-4xl mx-auto bg-green-400 border-4 border-green-600 rounded-full px-4 py-2 shadow-xl flex items-center justify-between pointer-events-auto transform hover:scale-[1.01] transition-transform">
      <div class="flex items-center gap-3">
        <span class="text-2xl animate-bounce">üßÆ</span>
        <span id="info-text" class="text-lg font-bold text-green-900 leading-none mt-1">Pilih aktiviti untuk
          mula!</span>
      </div>
      <button id="speak-btn" onclick="speakInfo()"
        class="bg-white hover:bg-green-50 text-green-600 border-2 border-green-200 rounded-full p-2 transition-colors shadow-sm">üîä</button>
    </div>
  </div>
  <div class="h-4"></div>

  <div class="flex-1 w-full max-w-5xl mx-auto p-2 flex flex-col min-h-0">
    <div class="game-card p-4 mb-2 flex-1 w-full">
      <div id="activity-content" class="w-full h-full relative z-10 flex flex-col overflow-hidden">
        <div class="py-10 text-center flex flex-col justify-center h-full">
          <div class="text-6xl mb-4 animate-pulse">üéØ</div>
          <h2 class="text-3xl font-bold text-emerald-600 mb-2">Latihan Operasi Tolak</h2>
          <p class="text-lg text-slate-500 mb-4 font-semibold">Jom uji kemahiran mengira info.</p>
          <div class="text-2xl animate-bounce">üëá</div>
        </div>
      </div>
    </div>

    <div class="flex-none bg-white/80 backdrop-blur-sm rounded-3xl shadow-lg p-2 border-2 border-white">
      <h3 class="text-lg font-bold text-slate-700 mb-2 text-center">üéÆ Pilih Aktiviti</h3>
      <div class="grid grid-cols-5 gap-2 mb-2">
        <button onclick="loadActivity(1)"
          class="btn-3d bg-blue-500 text-white font-bold py-2 px-1 rounded-xl text-xs">üéØ<br>Asas</button>
        <button onclick="loadActivity(2)"
          class="btn-3d bg-emerald-500 text-white font-bold py-2 px-1 rounded-xl text-xs">üßÆ<br>Simulasi</button>
        <button onclick="loadActivity(3)"
          class="btn-3d bg-violet-500 text-white font-bold py-2 px-1 rounded-xl text-xs">ü§î<br>Konsep</button>
        <button onclick="loadActivity(4)"
          class="btn-3d bg-orange-500 text-white font-bold py-2 px-1 rounded-xl text-xs">‚úèÔ∏è<br>Latihan</button>
        <button onclick="loadActivity(5)"
          class="btn-3d bg-rose-500 text-white font-bold py-2 px-1 rounded-xl text-xs">üß±<br>Blok</button>
      </div>
      <div class="flex justify-center gap-4 border-t-2 border-slate-100 pt-2">
        <button onclick="clearActivity()"
          class="btn-3d bg-slate-400 text-white font-bold py-1 px-4 rounded-full text-sm">üè† Menu</button>
        <button onclick="nextActivity()"
          class="btn-3d bg-indigo-500 text-white font-bold py-1 px-6 rounded-full text-base">Seterusnya ‚û°Ô∏è</button>
      </div>
    </div>
  </div>

  <script>
    /* --- STANDARD HELPERS (KONSISTEN) --- */
    let currentActivity = 0;
    let ttsEnabled = false;
    let currentInfo = "Selamat datang!";

    function triggerWin() { confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 } }); }

    function speak(text) {
      if (!ttsEnabled || !('speechSynthesis' in window)) return;
      window.speechSynthesis.cancel();
      const u = new SpeechSynthesisUtterance(text);
      u.lang = 'ms-MY'; u.rate = 0.9; u.pitch = 1.1;
      const voices = window.speechSynthesis.getVoices();
      const ms = voices.find(v => v.lang === 'ms-MY' || v.lang?.startsWith('ms'));
      if (ms) u.voice = ms;
      window.speechSynthesis.speak(u);
    }

    function setInfo(text) {
      currentInfo = text;
      const infoEl = document.getElementById('info-text');
      infoEl.style.opacity = 0;
      setTimeout(() => { infoEl.textContent = text; infoEl.style.opacity = 1; }, 200);
    }

    function speakInfo() {
      if (!ttsEnabled) {
        ttsEnabled = true;
        document.getElementById('speak-btn').classList.add('bg-green-100', 'text-green-600');
      }
      speak(currentInfo);
    }

    /* --- ROUTER --- */
    function loadActivity(n) {
      currentActivity = n;
      const content = document.getElementById('activity-content');
      content.style.opacity = 0;
      setTimeout(() => {
        if (n === 1) loadTolakAsas(content);
        if (n === 2) loadSimulasiTanpaPinjam(content);
        if (n === 3) loadKonsepPinjam(content);
        if (n === 4) loadSimulasiDenganPinjam(content);
        if (n === 5) loadPecahBlok(content);
        content.style.opacity = 1;
      }, 200);
    }

    function clearActivity() {
      currentActivity = 0;
      document.getElementById('activity-content').innerHTML = `<div class="py-10 text-center flex flex-col justify-center h-full"><div class="text-6xl mb-4 animate-pulse">üéØ</div><h2 class="text-3xl font-bold text-emerald-600 mb-2">Latihan Operasi Tolak</h2><p class="text-lg text-slate-500 mb-4 font-semibold">Pilih aktiviti di bawah.</p></div>`;
      setInfo("Pilih aktiviti untuk mula belajar!");
    }
    function nextActivity() { let next = currentActivity + 1; if (next > 5) next = 1; loadActivity(next); }


    /* =========================================
       LOGIK AKTIVITI (ADAPTASI DARI SOURCE CODE USER)
       ========================================= */

    /* 1. Tolak Asas (Simple Buttons) */
    function loadTolakAsas(content) {
      setInfo("Jom tolak nombor mudah. 8 - 2 = ?");
      content.innerHTML = `
        <h3 class="text-xl font-bold text-blue-500 mb-4 text-center flex-none">üéØ Tolak Asas</h3>
        <div class="flex-1 w-full overflow-y-auto px-4 flex flex-col items-center">
            <div class="bg-blue-50 rounded-3xl p-4 border-4 border-blue-100 inline-block mb-4 flex-none">
                <div class="text-6xl font-bold text-slate-700">8 - 2 = <span id="q-mark" class="text-blue-500">?</span></div>
            </div>
            <div class="flex justify-center gap-4 mt-2 flex-none">
               <button onclick="checkAsas(this, 5)" class="btn-3d bg-white text-blue-600 border-2 border-blue-200 text-3xl font-bold w-16 h-16 rounded-2xl shadow-sm hover:bg-blue-50">5</button>
               <button onclick="checkAsas(this, 6)" class="btn-3d bg-white text-blue-600 border-2 border-blue-200 text-3xl font-bold w-16 h-16 rounded-2xl shadow-sm hover:bg-blue-50">6</button>
               <button onclick="checkAsas(this, 7)" class="btn-3d bg-white text-blue-600 border-2 border-blue-200 text-3xl font-bold w-16 h-16 rounded-2xl shadow-sm hover:bg-blue-50">7</button>
            </div>
            <div id="asas-result" class="mt-4 text-xl font-bold h-10 text-center flex-none"></div>
        </div>
      `;
    }

    window.checkAsas = function (btn, val) {
      const res = document.getElementById('asas-result');
      const q = document.getElementById('q-mark');
      if (val === 6) {
        res.textContent = "Betul! 8 - 2 = 6"; res.className = "mt-8 text-3xl font-bold text-green-500 animate-bounce";
        q.textContent = "6"; q.className = "text-green-500";
        setInfo("Tahniah! Jawapan betul."); speak("Tahniah! Jawapan betul."); triggerWin();
      } else {
        res.textContent = "Cuba lagi..."; res.className = "mt-8 text-2xl font-bold text-red-400";
        btn.classList.add('shake'); setTimeout(() => btn.classList.remove('shake'), 500);
        setInfo("Salah. Cuba lagi."); speak("Salah. Cuba lagi.");
      }
    }

    /* 2. Latihan Tanpa Pinjam (Input Fields) */
    function loadSimulasiTanpaPinjam(content) {
      setInfo("Selesaikan 798 - 302. Mula dari rumah Sa.");
      content.innerHTML = `
        <h3 class="text-xl font-bold text-emerald-500 mb-2 text-center flex-none">üßÆ Latihan (Tanpa Pinjam)</h3>
        <div class="flex-1 w-full overflow-y-auto px-4 flex flex-col items-center justify-center">
            <div class="alg-grid-input shadow-xl flex-none">
               <div class="alg-label"></div><div class="alg-label">Ra</div><div class="alg-label">Pu</div><div class="alg-label">Sa</div>
               
               <div class="alg-num"></div><div class="alg-num">7</div><div class="alg-num">9</div><div class="alg-num">8</div>
               <div class="text-2xl text-slate-400 flex items-center justify-center">-</div>
               <div class="alg-num">3</div><div class="alg-num">0</div><div class="alg-num">2</div>
               
               <div class="line-sep"></div>
               
               <div></div>
               <input id="ans-ra" class="ans-input" maxlength="1" disabled placeholder="?">
               <input id="ans-pu" class="ans-input" maxlength="1" disabled placeholder="?">
               <input id="ans-sa" class="ans-input pulse" maxlength="1" placeholder="?">
            </div>
            <div id="sim-1-msg" class="text-center mt-4 text-base text-slate-500 font-semibold flex-none">8 - 2 = ? Masukkan jawapan.</div>
        </div>
      `;

      const sa = document.getElementById('ans-sa'); sa.focus();
      const pu = document.getElementById('ans-pu');
      const ra = document.getElementById('ans-ra');

      sa.addEventListener('input', (e) => {
        if (e.target.value === '6') {
          sa.disabled = true; sa.classList.remove('pulse');
          pu.disabled = false; pu.classList.add('pulse'); pu.focus();
          setInfo("Betul! Sekarang Puluh: 9 - 0 = ?"); speak("Betul! Sekarang tolak puluh.");
        } else if (e.target.value) { sa.value = ''; sa.classList.add('shake'); setTimeout(() => sa.classList.remove('shake'), 400); }
      });

      pu.addEventListener('input', (e) => {
        if (e.target.value === '9') {
          pu.disabled = true; pu.classList.remove('pulse');
          ra.disabled = false; ra.classList.add('pulse'); ra.focus();
          setInfo("Tepat! Sekarang Ratus: 7 - 3 = ?"); speak("Tepat! Sekarang tolak ratus.");
        } else if (e.target.value) { pu.value = ''; pu.classList.add('shake'); setTimeout(() => pu.classList.remove('shake'), 400); }
      });

      ra.addEventListener('input', (e) => {
        if (e.target.value === '4') {
          ra.disabled = true; ra.classList.remove('pulse');
          document.getElementById('sim-1-msg').textContent = "Syabas! 798 - 302 = 496";
          document.getElementById('sim-1-msg').className = "text-center mt-6 text-2xl text-emerald-600 font-bold animate-bounce";
          setInfo("Tahniah! Jawapan anda 496."); speak("Tahniah! Jawapan anda 496."); triggerWin();
        } else if (e.target.value) { ra.value = ''; ra.classList.add('shake'); setTimeout(() => ra.classList.remove('shake'), 400); }
      });
    }

    /* 3. Eksplorasi Pinjam (Visual Concept) */
    function loadKonsepPinjam(content) {
      setInfo("Lihat bagaimana 503 meminjam untuk bersedia.");
      content.innerHTML = `
          <h3 class="text-xl font-bold text-violet-500 mb-2 text-center flex-none">ü§î Konsep Pinjam</h3>
          <div class="flex-1 w-full overflow-y-auto px-4 flex flex-col items-center">
              <div class="flex justify-center my-4 flex-none">
                <div class="bg-white p-4 rounded-3xl border-4 border-slate-200 shadow-lg flex gap-2 items-end">
                     <div id="digit-ratus" class="alg-num w-16 text-4xl font-bold text-slate-700">5</div>
                     <div id="digit-puluh" class="alg-num w-16 text-4xl font-bold text-slate-700">0</div>
                     <div id="digit-sa" class="alg-num w-16 text-4xl font-bold text-slate-700">3</div>
                </div>
              </div>

              <div class="flex justify-center gap-2 flex-none">
                <button id="btn-p1" onclick="doPinjam1()" class="btn-3d bg-violet-500 text-white font-bold py-2 px-4 rounded-xl text-md pulse">1. Pinjam Ra ‚û°Ô∏è Pu</button>
                <button id="btn-p2" onclick="doPinjam2()" class="btn-3d bg-slate-400 text-white font-bold py-2 px-4 rounded-xl text-md" disabled>2. Pinjam Pu ‚û°Ô∏è Sa</button>
              </div>
          </div>
        `;
    }

    window.doPinjam1 = function () {
      document.getElementById('digit-ratus').innerHTML = `<span class="alg-num-potong">5</span><span class="alg-num-atas">4</span>`;
      document.getElementById('digit-puluh').innerHTML = `<span class="alg-num-potong">0</span><span class="alg-num-atas">10</span>`;

      const btn1 = document.getElementById('btn-p1');
      const btn2 = document.getElementById('btn-p2');
      btn1.disabled = true; btn1.className = "btn-3d bg-slate-300 text-white font-bold py-3 px-6 rounded-xl text-xl";
      btn2.disabled = false; btn2.className = "btn-3d bg-violet-500 text-white font-bold py-3 px-6 rounded-xl text-xl pulse";

      setInfo("Bagus! 5 Ratus bagi 1 Ratus dekat Puluh. Jadi 10 Puluh."); speak("Bagus! 5 Ratus bagi 1 Ratus dekat Puluh.");
    }

    window.doPinjam2 = function () {
      document.getElementById('digit-puluh').innerHTML = `<span class="alg-num-potong">0</span><span class="alg-num-atas" style="text-decoration:line-through; opacity:0.6; color:#ef4444">10</span><div style="position:absolute;top:-45px;left:50%;transform:translateX(-50%);color:#22c55e;font-weight:800;background:#dcfce7;padding:2px 8px;border:2px solid #22c55e;border-radius:8px;">9</div>`;
      document.getElementById('digit-sa').innerHTML = `<span class="alg-pinjam-sebelah">1</span>3`;

      document.getElementById('btn-p2').disabled = true;
      document.getElementById('btn-p2').className = "btn-3d bg-slate-300 text-white font-bold py-3 px-6 rounded-xl text-xl";

      setInfo("Sekarang Sa pinjam dari Puluh. Nombor sedia ditolak!"); speak("Sekarang Sa pinjam dari Puluh. Nombor sedia ditolak!"); triggerWin();
    }

    /* 4. Latihan Dengan Pinjam (Inputs + Button) */
    function loadSimulasiDenganPinjam(content) {
      setInfo("Selesaikan 503 - 394. Sa tak cukup!");
      content.innerHTML = `
            <h3 class="text-xl font-bold text-orange-500 mb-2 text-center flex-none">‚úèÔ∏è Latihan Pinjam</h3>
            <div class="flex-1 w-full overflow-y-auto px-4 flex flex-col items-center">
                <div class="flex justify-center relative flex-none">
                    <div class="alg-grid-input shadow-xl">
                       <div class="alg-label"></div><div class="alg-label">Ra</div><div class="alg-label">Pu</div><div class="alg-label">Sa</div>
                       
                       <div class="alg-num"></div>
                       <div class="alg-num" id="num-ra">5</div>
                       <div class="alg-num" id="num-pu">0</div>
                       <div class="alg-num" id="num-sa">3</div>
                       
                       <div class="text-2xl text-slate-400 flex items-center justify-center">-</div>
                       <div class="alg-num">3</div><div class="alg-num">9</div><div class="alg-num">4</div>
                       
                       <div class="line-sep"></div>
                       
                       <div></div>
                       <input id="ans-ra" class="ans-input" maxlength="1" disabled>
                       <input id="ans-pu" class="ans-input" maxlength="1" disabled>
                       <input id="ans-sa" class="ans-input" maxlength="1" disabled>
                    </div>
                </div>
                
                <div class="text-center mt-4 flex-none">
                   <button id="btn-borrow-act" onclick="doBorrowAction()" class="btn-3d bg-orange-500 text-white font-bold py-2 px-6 rounded-full text-lg pulse">üÜò Klik Sini Untuk Pinjam</button>
                </div>
            </div>
        `;
    }

    let borrowStep = 0;
    window.doBorrowAction = function () {
      const btn = document.getElementById('btn-borrow-act');
      borrowStep++;

      if (borrowStep === 1) {
        document.getElementById('num-ra').innerHTML = `<span class="alg-num-potong">5</span><span class="alg-num-atas">4</span>`;
        document.getElementById('num-pu').innerHTML = `<span class="alg-num-potong">0</span><span class="alg-num-atas">10</span>`;
        setInfo("Pinjam Ratus dulu. Klik lagi untuk pinjam ke Sa."); speak("Pinjam Ratus dulu. Klik lagi untuk pinjam ke Sa.");
      }
      else if (borrowStep === 2) {
        document.getElementById('num-pu').innerHTML = `<span class="alg-num-potong">0</span><span class="alg-num-atas" style="text-decoration:line-through; opacity:0.6; color:#ef4444">10</span><div style="position:absolute;top:-55px;left:50%;transform:translateX(-50%);color:#22c55e;font-weight:800;background:#dcfce7;padding:2px 8px;border:2px solid #22c55e;border-radius:8px;">9</div>`;
        document.getElementById('num-sa').innerHTML = `<span class="alg-pinjam-sebelah">1</span>3`;

        btn.style.display = 'none';
        setInfo("Sedia! Selesaikan Sa: 13 - 4 = ?"); speak("Sedia! Selesaikan Sa, tiga belas tolak empat.");

        const sa = document.getElementById('ans-sa'); sa.disabled = false; sa.classList.add('pulse'); sa.focus();
        setupInputsPinjam();
      }
    }

    function setupInputsPinjam() {
      const sa = document.getElementById('ans-sa');
      const pu = document.getElementById('ans-pu');
      const ra = document.getElementById('ans-ra');

      sa.addEventListener('input', (e) => {
        if (e.target.value === '9') {
          sa.disabled = true; sa.classList.remove('pulse');
          pu.disabled = false; pu.classList.add('pulse'); pu.focus();
          setInfo("Betul! Puluh: 9 - 9 = ?");
        } else if (e.target.value) { sa.value = ''; sa.classList.add('shake'); setTimeout(() => sa.classList.remove('shake'), 400); }
      });

      pu.addEventListener('input', (e) => {
        if (e.target.value === '0') {
          pu.disabled = true; pu.classList.remove('pulse');
          ra.disabled = false; ra.classList.add('pulse'); ra.focus();
          setInfo("Betul! Ratus: 4 - 3 = ?");
        } else if (e.target.value) { pu.value = ''; pu.classList.add('shake'); setTimeout(() => pu.classList.remove('shake'), 400); }
      });

      ra.addEventListener('input', (e) => {
        if (e.target.value === '1') {
          ra.disabled = true; ra.classList.remove('pulse');
          setInfo("Hebat! Jawapan 109."); speak("Hebat! Jawapan 109."); triggerWin();
        } else if (e.target.value) { ra.value = ''; ra.classList.add('shake'); setTimeout(() => ra.classList.remove('shake'), 400); }
      });
    }

    /* 5. Pecah Blok (Visuals) */
    function loadPecahBlok(content) {
      setInfo("Macam mana 1 Ratus pecah jadi Puluh?");
      content.innerHTML = `
         <h3 class="text-xl font-bold text-rose-500 mb-2 text-center flex-none">üß± Pecah Blok</h3>
         <div class="flex-1 w-full overflow-y-auto px-4 flex flex-col items-center">
             <div class="bg-white border-4 border-rose-100 rounded-3xl min-h-[200px] w-full flex items-center justify-center relative p-4 flex-none">
                 <div id="block-space" class="block-container">
                     <button id="start-block-btn" onclick="startBlocks()" class="btn-3d bg-rose-500 text-white font-bold py-2 px-4 rounded-xl text-lg">Ambil 1 Blok Ratus</button>
                 </div>
             </div>
             <div id="block-info" class="text-center mt-2 text-lg font-bold text-rose-800 flex-none"></div>
         </div>
      `;
    }

    window.startBlocks = function () {
      const space = document.getElementById('block-space');
      space.innerHTML = '';
      const b = document.createElement('div');
      b.className = 'block block-ratus animate-bounce';
      b.innerHTML = "RATUS";
      b.onclick = function () {
        this.remove();
        for (let i = 0; i < 10; i++) {
          const p = document.createElement('div');
          p.className = 'block block-puluh';
          p.innerHTML = 'PU';
          p.onclick = function () {
            this.remove();
            for (let j = 0; j < 10; j++) {
              const s = document.createElement('div');
              s.className = 'block block-sa';
              space.appendChild(s);
            }
            setInfo("1 Puluh pecah jadi 10 Sa."); speak("1 Puluh pecah jadi 10 Sa.");
            document.getElementById('block-info').textContent = "9 Puluh + 10 Sa";
          }
          space.appendChild(p);
        }
        setInfo("1 Ratus pecah jadi 10 Puluh. Klik Puluh untuk pecah lagi."); speak("1 Ratus pecah jadi 10 Puluh.");
        document.getElementById('block-info').textContent = "10 Puluh";
      };
      space.appendChild(b);
      setInfo("Klik blok Ratus untuk pecahkan.");
    }

  </script>
</body>

</html>